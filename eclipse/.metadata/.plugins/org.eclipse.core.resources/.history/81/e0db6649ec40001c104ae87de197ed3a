package znick_.biomesabroad.generation;

import java.util.Random;

import net.minecraft.world.World;
import net.minecraft.world.biome.BiomeGenBase;
import net.minecraft.world.gen.feature.WorldGenerator;
import znick_.biomesabroad.util.helper.BAMathHelper;

/**
 * Class with a single static method that generates a structure such as a tree
 * or flower.
 */
public class StructureGenerator {

	/**
	 * Static method that pseudo-randomly generates a structure
	 * @param world the world that the structure is generating in
	 * @param rand an instance of java's Random class. 
	 * @param chunkX the x-coordinate of the chunk to generate in
	 * @param chunkZ the z-coordinate of the chunk to generate in
	 * @param rootHeight the median height of the biome to generate in
	 * @param toGenerate the class containing the schematics for the structure
	 * @param chance the amount of times per chunk to generate the structure, or the chance for it to generate on any given chunk
	 * 
	 * @return void
	 * 
	 * @see BiomeGenBase
	*/
	public static void generateStructure(World world, Random rand, int chunkX, int chunkZ, float rootHeight, WorldGenerator toGenerate, float chance) {

		if (chance < 1) {

			if (Math.random() < chance) {
				int randX = chunkX + rand.nextInt(8) - rand.nextInt(16);
				int y = (int) (BAMathHelper.map(rootHeight, -2, 2, 0, 128));
				int randZ = chunkZ + rand.nextInt(8) - rand.nextInt(16);
				
				WorldGenerator inst = null;
				try {inst = toGenerate.newInstance();} 
				catch (Exception e) {e.printStackTrace();}

				if (inst != null) {
					for (int i = -100; i < 100; i++) {
						inst.generate(world, rand, randX, y + i, randZ);
					}
				}
			}
		} else {
			for (int j = 0; j < chance; j++) {
				int y = (int) (BAMathHelper.map(rootHeight, -2, 2, 0, 128));
				int randX = chunkX + rand.nextInt(8) - rand.nextInt(16);
				int randZ = chunkZ + rand.nextInt(8) - rand.nextInt(16);
				WorldGenerator inst = null;

				try {
					inst = toGenerate.newInstance();
				} catch (Exception e) {
					e.printStackTrace();
				}

				if (inst != null) {
					for (int i = -100; i < 100; i++) {
						inst.generate(world, rand, randX, y + i, randZ);
					}
				}
			}
		}
	}

}
